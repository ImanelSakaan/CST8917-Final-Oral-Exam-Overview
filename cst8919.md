flowchart TD
  A[🔐 User Login Attempt] --> B{🛑 Failed Login?}
  B -- Yes --> C[📊 Log to Azure Monitor / Sentinel]
  C --> D[🧠 Check if 5+ failures in 10 min (KQL/Logic App)]
  D -- Yes --> E[🔒 Lock Account Temporarily (via API)]
  E --> F[📧 Send Password Reset Email]
  F --> G[📥 Log to Audit Store]
  G --> H[📣 Alert Security Team (Email/MS Teams)]
  D -- No --> Z[🔁 Wait for more events]
  B -- No --> Y[✅ Normal Login]

style A fill:#D6EAF8
style F fill:#FADBD8
style H fill:#F9E79F
style Y fill:#D5F5E3
